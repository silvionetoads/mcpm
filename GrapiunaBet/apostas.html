<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrapiúnaBet</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPDF/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrious@latest/dist/qrious.min.js"></script>
</head>
<body>
    <div class="container">
        <h1 class="my-4">Faça sua Aposta</h1>
        <form id="betForm">
            <div class="form-group">
                <label for="name">Seu Nome</label>
                <input type="text" id="name" class="form-control" placeholder="Digite seu nome" required>
            </div>
            <div class="form-group">
                <label for="betType">Escolha o Tipo de Aposta</label>
                <select id="betType" class="form-control" required>
                    <option value="">Selecione...</option>
                    <option value="homeWin">Ganhador da Casa (Flamengo)</option>
                    <option value="awayWin">Ganhador de Fora (Palmeiras)</option>
                    <option value="draw">Empate</option>
                    <option value="noGoal">Sem Gol</option>
                </select>
            </div>
            <div class="form-group">
                <label for="amount">Valor da Aposta (R$)</label>
                <input type="number" id="amount" class="form-control" placeholder="Digite o valor" required>
            </div>
            <button type="button" id="submitBet" class="btn btn-primary">Confirmar Aposta</button>
        </form>
        <div id="result" class="mt-4"></div>
    </div>
    <script>
        document.getElementById('submitBet').addEventListener('click', () => {
            const name = document.getElementById('name').value;
            const betType = document.getElementById('betType').value;
            const amount = document.getElementById('amount').value;

            if (name && betType && amount) {
                const now = new Date();
                const dateTime = now.toLocaleString();
                const betData = `Nome: ${name}, Valor: R$${amount}, Tipo de Aposta: ${betType}, Data e Hora: ${dateTime}`;
                
                // Salva a aposta no localStorage
                const bets = JSON.parse(localStorage.getItem('bets')) || [];
                bets.push(betData);
                localStorage.setItem('bets', JSON.stringify(bets));

                // Gera QR Code
                const qr = new QRious({
                    element: document.createElement('canvas'),
                    value: betData,
                    size: 150
                });
                document.getElementById('result').innerHTML = `
                    <h3>Aposta Confirmada!</h3>
                    <p>${betData}</p>
                    <p><strong>QR Code:</strong></p>
                    <img src="${qr.toDataURL()}" alt="QR Code"/>
                    <button id="downloadPdf" class="btn btn-secondary mt-2">Baixar Extrato</button>
                `;

                document.getElementById('downloadPdf').addEventListener('click', () => {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    doc.text(betData, 10, 10);
                    doc.save('extrato_aposta.pdf');
                });
            } else {
                alert('Por favor, preencha todos os campos.');
            }
        });
    </script>
</body>
</html>
